const express = require('express');
const router = express.Router();
const {
  getVulnerabilities,
  getVulnerabilityById,
  getDashboardStats,
  getVulnerabilitiesOverTime,
  getRiskFactors,
} = require('../controllers/vulnerabilityController');

// GET /api/vulnerabilities - Get all vulnerabilities with filtering
router.get('/', getVulnerabilities);

// GET /api/vulnerabilities/stats - Get dashboard statistics
router.get('/stats', getDashboardStats);

// GET /api/vulnerabilities/timeline - Get vulnerabilities over time
router.get('/timeline', getVulnerabilitiesOverTime);

// GET /api/vulnerabilities/risk-factors - Get risk factors summary
router.get('/risk-factors', getRiskFactors);

// GET /api/vulnerabilities/:id - Get single vulnerability by ID
router.get('/:id', getVulnerabilityById);

module.exports = router;
